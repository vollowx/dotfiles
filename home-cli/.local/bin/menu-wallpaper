#!/usr/bin/env bash
set -Eeuo pipefail

base=$(xdg-user-dir PICTURES)

if [ ! -d "$base/Wallpapers" ]; then
  exit 1
fi

cd "$base/Wallpapers/"
choice=$(find -type f -printf '%P\n' | ${1:-fzf} --prompt "wallpaper> ")

if [ -z "$choice" ]; then
  exit 1
fi

ln -sf "$base/Wallpapers/$choice" "$base/wallpaper"
md3-generate image "$base/wallpaper"
notify-send -r 667 -t 1000 "Sway" "$choice\nis the wallpaper now"
